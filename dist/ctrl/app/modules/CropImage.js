define(["croppie","app/modules/Upload"],function(o,i){return function(){var t=null,r=this;function o(){}return o.setOptions=function(o){r.options=o},o.setUid=function(o){r.uid=o},o.setCallBack=function(o){t=o},o.setUploadToken=function(o){r.upload_token=o},o.setUploadCropZone=function(o){(r.$uploadCropZone=o).croppie("destroy"),r.$uploadCrop=o.croppie(r.options)},o.crop=function(){r.$uploadCropZone.croppie("result",{type:"blob",size:"viewport",format:"jpeg",backgroundColor:"white"}).then(function(o){var e=new i;e.init(r.upload_token,r.uid);var n=e.blobToFile(o,"x.jpg");e.setCallBack(function(o){null!=t&&t(o)}),e.addFile(n),e.upload()})},o.readFile=function(o){if(o.files&&o.files[0]){var e=new FileReader;return e.onload=function(o){r.$uploadCropZone.addClass("ready"),r.$uploadCrop.croppie("bind",{url:o.target.result}).then(function(){})},e.readAsDataURL(o.files[0]),!0}return console.log("Sorry - you're browser doesn't support the FileReader API"),!1},o}});